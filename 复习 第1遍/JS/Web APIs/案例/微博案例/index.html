<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./style.css">
</head>

<body>
    <div class="w">
        <div class="control">
            <img src="./images/tip.png" alt=""><br>
            <!-- 可以直接将表单的长度控制在200 -->
            <textarea placeholder="说点什么..." name="" id="area" cols="30" rows="10" maxlength="200"></textarea>
            <div class="releaseInfo">
                <span class="count">0</span>
                <span>/</span>
                <span>200</span>
                <button id="release">发布</button>
            </div>
        </div>
        <!-- 发布内容显示区 -->
        <div class="contentlist">
            <ul id="list">
                <!-- 留言的主体内容区 -->
                <!-- <li hidden>
                    <div class="info">
                        <img class="userpic" src="./images/9.6/03.jpg" alt="">
                        <span class="username">死数据：百里守约</span>
                        <p class="send-time">死数据：发布于 2020年12月05日 00:07:54</p>
                    </div>
                    <div class="content">死数据：111</div>
                    <span class="the_del">X</span>
                </li> -->
            </ul>
        </div>
    </div>

    <script>
        // 导入数据
        let dataArr = [{ uname: '司马懿', imgSrc: './images/9.5/01.jpg' },
        { uname: '女娲', imgSrc: './images/9.5/02.jpg' },
        { uname: '百里守约', imgSrc: './images/9.5/03.jpg' },
        { uname: '亚瑟', imgSrc: './images/9.5/04.jpg' },
        { uname: '虞姬', imgSrc: './images/9.5/05.jpg' },
        { uname: '张良', imgSrc: './images/9.5/06.jpg' },
        { uname: '安其拉', imgSrc: './images/9.5/07.jpg' },
        { uname: '李白', imgSrc: './images/9.5/08.jpg' },
        { uname: '阿珂', imgSrc: './images/9.5/09.jpg' },
        { uname: '墨子', imgSrc: './images/9.5/10.jpg' },
        { uname: '鲁班', imgSrc: './images/9.5/11.jpg' },
        { uname: '嬴政', imgSrc: './images/9.5/12.jpg' },
        { uname: '孙膑', imgSrc: './images/9.5/13.jpg' },
        { uname: '周瑜', imgSrc: './images/9.5/14.jpg' },
        { uname: '老夫子', imgSrc: './images/9.5/15.jpg' },
        { uname: '狄仁杰', imgSrc: './images/9.5/16.jpg' },
        { uname: '扁鹊', imgSrc: './images/9.5/17.jpg' },
        { uname: '马可波罗', imgSrc: './images/9.5/18.jpg' },
        { uname: '露娜', imgSrc: './images/9.5/19.jpg' },
        { uname: '孙悟空', imgSrc: './images/9.5/20.jpg' },
        { uname: '黄忠', imgSrc: './images/9.5/21.jpg' },
        { uname: '百里玄策', imgSrc: './images/9.5/22.jpg' },]
        let textArea = document.querySelector('#area')
        let count = document.querySelector('.count')
        // 发布按钮
        let release = document.querySelector('#release')
        let ul = document.querySelector('#list')
        textArea.addEventListener('input', function () {
            count.innerHTML = area.value.length
        })
        // 输入不能为空： 判断标准 就是点击button之后 看input里的内容是否为空
        // 为防止无意义空格 使用字符串 .trim()去掉首尾空格
        release.addEventListener('click', function () {
            if (textArea.value.trim() === '') {
                textArea.value = ''
                count.innerHTML = 0
                return alert('内容不能为空')
            }

            // 随机数
            function getRandom(min, max) {
                return Math.floor(Math.random() * (max - min + 1)) + min
            }
            // 当内容不为空时 新增留言板
            let random = getRandom(0, dataArr.length - 1)
            // 创建一个li
            let li = document.createElement('li')
            li.innerHTML = ` <div class="info">
                    <img class="userpic" src=${dataArr[random].imgSrc} alt="">
                    <span class="username">${dataArr[random].uname}</span>
                    <p class="send-time">${new Date().toLocaleString()}</p>
                    </div>
                    <div class="content">${textArea.value}</div>
                    <span class="the_del">X</span>`
            // 删除留言 放到追加的前面
            let del = li.querySelector('.the_del')
            del.addEventListener('click', function () {
                ul.removeChild(li)
            })
            ul.insertBefore(li, ul.children[0])

            // 重置
            textArea.value = ''
            count.innerHTML = 0

        })

        // 按下回车键 可以发布
        textArea.addEventListener('keyup', function (e) {
            if (e.key === 'Enter') {
                // 自动触发按钮点击

                release.click()
            }
        })

    </script>
</body>

</html>